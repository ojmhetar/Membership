<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
        <title>E-Club Membership</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
        <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.5.0.min.js"></script>
        <link rel="stylesheet" href="style.css">
    </head>
    
    <body>
        <div class="cover test">
            <div class="cover-image" style="background-image: url(https://unsplash.imgix.net/photo-1418065460487-3e41a6c84dc5?q=25&amp;fm=jpg&amp;s=127f3a3ccf4356b7f79594e05f6c840e);"></div>
            <div class="form-group form-inline center_div">
                <input id="pid" placeholder="Enter your pid.." class="form-control">
                <input value="Sign In" class="btn" type="submit" onclick="checkStatus()">
            </div>
        </div>
        <form></form>
        <script type="text/javascript">
            Parse.initialize("J0JsHygaFYRl0SmlsxKsGFxvlhoSq6bX7rWjXVZO", "qjD9f0paPXpEvygwlIK184c5GbViKFAG9yG6oFyy");
              
                function checkStatus() { 
                    
                    var pid = document.getElementById("pid").value;
                    var UserObject = Parse.Object.extend("UserObject"); 
                    var userObject = new UserObject();      
                    var query = new Parse.Query(UserObject);
                
                    
                    query.equalTo("name", pid); 
                    query.find({
                        success: function(users) {
                            
                            if(users.length === 1) { 
                                var user = users[0];
                                user.increment("count");
                                user.save();
                                var amount = user.get("count");
                
                                window.open("existingmember.html?" + amount,"_self")
                            
                            }
                            else if(users.length === 0){
                               userObject.save({name : pid, count:1}).then(function(object) { 
                                    window.open("newmember.html","_self")
                               })
                            }
                            else {
                                alert("There's been an error, contact EClub rep."); 
                            }
                            
                             
                        },
                        error: function(error) {
                            console.log("There's been an error.");
                        }
                    });
                }
        </script>
    </body>

</html>